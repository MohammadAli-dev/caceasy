(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[656],{4202:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/batches",function(){return s(4262)}])},2653:function(e,t,s){"use strict";var a=s(418),n=s(3542);let l=n.env.NEXT_PUBLIC_API_URL||"http://localhost:3000",r=a.Z.create({baseURL:l,timeout:3e4});r.interceptors.request.use(e=>{{let t=sessionStorage.getItem("admin_api_key");t&&(e.headers["x-admin-key"]=t)}return e}),r.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(sessionStorage.removeItem("admin_api_key"),window.location.href="/login"),Promise.reject(e)}),t.Z=r},4262:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var a=s(2322),n=s(2784),l=s(5632),r=s(2653),c=s(2202);function i(){let e=(0,l.useRouter)(),[t,s]=(0,n.useState)([]),[i,d]=(0,n.useState)(!0),[o,u]=(0,n.useState)(!1),[h,m]=(0,n.useState)({name:"",sku:"",points_per_scan:10,quantity:100});(0,n.useEffect)(()=>{if(!sessionStorage.getItem("admin_api_key")){e.push("/login");return}p()},[]);let p=async()=>{try{let e=await r.Z.get("/admin/batches");s(e.data.batches)}catch(e){console.error("Error fetching batches:",e),c.ZP.error("Failed to fetch batches")}finally{d(!1)}},x=async()=>{try{await r.Z.post("/admin/batch",h),c.ZP.success("Batch created"),u(!1),m({name:"",sku:"",points_per_scan:10,quantity:100}),p()}catch(s){var e,t;c.ZP.error((null===(e=s.response)||void 0===e?void 0:null===(t=e.data)||void 0===t?void 0:t.error)||"Failed to create batch")}};return i?(0,a.jsx)("div",{className:"p-8",children:"Loading..."}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,a.jsx)("nav",{className:"bg-white shadow",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4 flex justify-between",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Batch Management"}),(0,a.jsx)("button",{onClick:()=>e.push("/"),className:"text-blue-600",children:"â† Dashboard"})]})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)("button",{onClick:()=>u(!0),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Create Batch"})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-3 text-left",children:"Name"}),(0,a.jsx)("th",{className:"p-3 text-left",children:"SKU"}),(0,a.jsx)("th",{className:"p-3 text-left",children:"Points"}),(0,a.jsx)("th",{className:"p-3 text-left",children:"Issued"}),(0,a.jsx)("th",{className:"p-3 text-left",children:"Redeemed"}),(0,a.jsx)("th",{className:"p-3 text-left",children:"Pending"})]})}),(0,a.jsx)("tbody",{children:t.map(e=>(0,a.jsxs)("tr",{className:"border-t",children:[(0,a.jsx)("td",{className:"p-3 font-semibold",children:e.name}),(0,a.jsx)("td",{className:"p-3",children:e.sku}),(0,a.jsx)("td",{className:"p-3",children:e.points_per_coupon}),(0,a.jsx)("td",{className:"p-3",children:e.issued}),(0,a.jsx)("td",{className:"p-3 text-green-600",children:e.redeemed}),(0,a.jsx)("td",{className:"p-3 text-yellow-600",children:e.pending})]},e.id))})]})})]}),o&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Create Batch"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("input",{type:"text",placeholder:"Batch Name",value:h.name,onChange:e=>m({...h,name:e.target.value}),className:"w-full border rounded p-2"}),(0,a.jsx)("input",{type:"text",placeholder:"SKU",value:h.sku,onChange:e=>m({...h,sku:e.target.value}),className:"w-full border rounded p-2"}),(0,a.jsx)("input",{type:"number",placeholder:"Points per Scan",value:h.points_per_scan,onChange:e=>m({...h,points_per_scan:parseInt(e.target.value)}),className:"w-full border rounded p-2"}),(0,a.jsx)("input",{type:"number",placeholder:"Quantity",value:h.quantity,onChange:e=>m({...h,quantity:parseInt(e.target.value)}),className:"w-full border rounded p-2"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,a.jsx)("button",{onClick:()=>u(!1),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded",children:"Cancel"}),(0,a.jsx)("button",{onClick:x,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Create"})]})]})})]})}}},function(e){e.O(0,[932,774,888,179],function(){return e(e.s=4202)}),_N_E=e.O()}]);